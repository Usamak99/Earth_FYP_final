{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/a/Documents/New folder (3)/mern-social-media-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/a/Documents/New folder (3)/mern-social-media-master/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/a/Documents/New folder (3)/mern-social-media-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{GLOBALTYPES}from\"./globalTypes\";import{postDataAPI,getDataAPI}from\"../../utils/fetchData\";export var MESSAGE_TYPES={ADD_USER:\"ADD_USER\",ADD_MESSAGE:\"ADD_MESSAGE\",GET_CONVERSATIONS:\"GET_CONVERSATIONS\",GET_MESSAGES:\"GET_MESSAGES\"};export var addUser=function addUser(_ref){var user=_ref.user,message=_ref.message;return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(message.users.every(function(item){return item._id!==user._id;})){dispatch({type:MESSAGE_TYPES.ADD_USER,payload:_objectSpread(_objectSpread({},user),{},{text:'',media:[]})});}case 1:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}();};export var addMessage=function addMessage(_ref3){var msg=_ref3.msg,auth=_ref3.auth,socket=_ref3.socket;return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:dispatch({type:MESSAGE_TYPES.ADD_MESSAGE,payload:msg});socket.emit('addMessage',msg);_context2.prev=2;_context2.next=5;return postDataAPI('message',msg,auth.token);case 5:_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](2);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context2.t0.response.data.msg}});case 10:case\"end\":return _context2.stop();}},_callee2,null,[[2,7]]);}));return function(_x2){return _ref4.apply(this,arguments);};}();};export var getConversations=function getConversations(_ref5){var auth=_ref5.auth,_ref5$page=_ref5.page,page=_ref5$page===void 0?1:_ref5$page;return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var res,newArr;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return getDataAPI(\"conversations?limit=\".concat(page*9),auth.token);case 3:res=_context3.sent;newArr=[];res.data.conversations.forEach(function(item){item.recipients.forEach(function(cv){if(cv._id!==auth.user._id){newArr.push(_objectSpread(_objectSpread({},cv),{},{text:item.text,media:item.media}));}});});dispatch({type:MESSAGE_TYPES.GET_CONVERSATIONS,payload:{newArr:newArr,result:res.data.result}});_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context3.t0.response.data.msg}});case 12:case\"end\":return _context3.stop();}},_callee3,null,[[0,9]]);}));return function(_x3){return _ref6.apply(this,arguments);};}();};export var getMessages=function getMessages(_ref7){var auth=_ref7.auth,id=_ref7.id,_ref7$page=_ref7.page,page=_ref7$page===void 0?1:_ref7$page;return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var res;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return getDataAPI(\"message/\".concat(id,\"?limit=\").concat(page*9),auth.token);case 3:res=_context4.sent;dispatch({type:MESSAGE_TYPES.GET_MESSAGES,payload:res.data});_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);dispatch({type:GLOBALTYPES.ALERT,payload:{error:_context4.t0.response.data.msg}});case 10:case\"end\":return _context4.stop();}},_callee4,null,[[0,7]]);}));return function(_x4){return _ref8.apply(this,arguments);};}();};","map":{"version":3,"names":["GLOBALTYPES","postDataAPI","getDataAPI","MESSAGE_TYPES","ADD_USER","ADD_MESSAGE","GET_CONVERSATIONS","GET_MESSAGES","addUser","_ref","user","message","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","wrap","_callee$","_context","prev","next","users","every","item","_id","type","payload","_objectSpread","text","media","stop","_x","apply","arguments","addMessage","_ref3","msg","auth","socket","_ref4","_callee2","_callee2$","_context2","emit","token","t0","ALERT","error","response","data","_x2","getConversations","_ref5","_ref5$page","page","_ref6","_callee3","res","newArr","_callee3$","_context3","concat","sent","conversations","forEach","recipients","cv","push","result","_x3","getMessages","_ref7","id","_ref7$page","_ref8","_callee4","_callee4$","_context4","_x4"],"sources":["C:/Users/a/Documents/New folder (3)/mern-social-media-master/client/src/redux/actions/messageAction.js"],"sourcesContent":["import { GLOBALTYPES } from \"./globalTypes\";\r\nimport { postDataAPI, getDataAPI } from \"../../utils/fetchData\";\r\n\r\n\r\nexport const MESSAGE_TYPES = {\r\n  ADD_USER: \"ADD_USER\",\r\n  ADD_MESSAGE: \"ADD_MESSAGE\",\r\n  GET_CONVERSATIONS: \"GET_CONVERSATIONS\",\r\n  GET_MESSAGES: \"GET_MESSAGES\",\r\n};\r\n\r\nexport const addUser = ({ user, message }) => async (dispatch) => {\r\n    if(message.users.every(item => item._id !== user._id)){\r\n        dispatch({type: MESSAGE_TYPES.ADD_USER, payload: {...user, text: '', media: []} });\r\n    }\r\n};\r\n\r\nexport const addMessage = ({ msg, auth, socket }) => async (dispatch) => {\r\n\r\n  dispatch({type: MESSAGE_TYPES.ADD_MESSAGE, payload: msg});\r\n  socket.emit('addMessage', msg);\r\n\r\n  try {\r\n    await postDataAPI('message', msg, auth.token)\r\n  } catch (err) {\r\n    dispatch({ type: GLOBALTYPES.ALERT, payload: {error: err.response.data.msg } });\r\n  }\r\n}\r\n\r\nexport const getConversations = ({auth, page = 1 }) => async (dispatch) => {\r\ntry {\r\n    const res = await getDataAPI(`conversations?limit=${page * 9}`, auth.token);\r\n    let newArr = [];\r\n    res.data.conversations.forEach(item => {\r\n      item.recipients.forEach(cv => {\r\n        if(cv._id !== auth.user._id){\r\n          newArr.push({...cv, text: item.text, media: item.media});\r\n        }\r\n      })\r\n    });\r\n\r\n    dispatch({ type: MESSAGE_TYPES.GET_CONVERSATIONS, payload: {newArr, result: res.data.result} });\r\n  } catch (err) {\r\n    dispatch({ type: GLOBALTYPES.ALERT, payload: {error: err.response.data.msg } });\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\nexport const getMessages = ({ auth, id, page = 1 }) => async (dispatch) => {\r\n  try {\r\n    const res = await getDataAPI(`message/${id}?limit=${page * 9}`, auth.token);\r\n\r\n    dispatch({ type: MESSAGE_TYPES.GET_MESSAGES, payload: res.data });\r\n  } catch (err) {\r\n    dispatch({\r\n      type: GLOBALTYPES.ALERT,\r\n      payload: { error: err.response.data.msg },\r\n    });\r\n  }\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}